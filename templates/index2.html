<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Light Switch</title>
    <script>
        function toggleLight(checkbox) {
            var state = checkbox.checked ? 'on' : 'off';
            fetch(`/toggle/${state}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('lightImage').src = data.image;
                    if (state === 'on') {
                        startTimer();
                    } else {
                        stopTimer();
                    }
                });
        }

        var timer = null;
        var seconds = 0;

        function startTimer() {
            stopTimer();
            seconds = 0;
            timer = setInterval(function() {
                document.getElementById('timer').innerText = ++seconds;
            }, 1000);
        }

        function stopTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
        }
    </script>
</head>
<body>
    <div class="content">
        <img id="lightImage" src="{{ url_for('static', filename='light_off.jpg') }}" alt="Light" class="center">
        <div class="mid">
            <label class="rocker">
                <input type="checkbox" id="lightSwitch" onclick="toggleLight(this)">
                <span class="switch-left">On</span>
                <span class="switch-right">Off</span>
            </label>
        </div>
        <div class="timer">Timer: <span id="timer">0</span> seconds</div>
    </div>
</body>
</html>